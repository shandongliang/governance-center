"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _tabs=require("antd/es/tabs"),_tabs2=_interopRequireDefault(_tabs);require("antd/es/tabs/style");var _react=require("react"),_react2=_interopRequireDefault(_react),_antd=require("antd"),_tabRouter=require("../../../../util/tabRouter.js"),_index=require("../../../../constant/index.js");require("./../../../common/style/index.less");var _queryComponent=require("../../../../component/busiProcess/queryComponent.js"),_queryComponent2=_interopRequireDefault(_queryComponent),_tableComponent=require("../../../../component/busiProcess/tableComponent.js"),_tableComponent2=_interopRequireDefault(_tableComponent),_selectNextApprover=require("../../../../component/busiProcess/selectNextApprover.js"),_selectNextApprover2=_interopRequireDefault(_selectNextApprover),_fetchBusiData=require("../../../../component/busiProcess/fetchBusiData.js"),_fetchBusiData2=_interopRequireDefault(_fetchBusiData),_defaultConfig=require("./defaultConfig.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var a,r=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){_defineProperty(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(a){var r=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(a);return _possibleConstructorReturn(this,r?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var TabPane=_tabs2.default.TabPane,BusiTodotaskIndexTask=function(){_inherits(a,_react.Component);var t=_createSuper(a);function a(e){var c;return _classCallCheck(this,a),_defineProperty(_assertThisInitialized(c=t.call(this,e)),"toDetail",function(t){return function(){var e={pathname:_index.IS_OPEN_MULTI_TABNAV?"/processManager/mytodotask/tdetail/"+t.taskId:"/processManager/mytodotask/tdetail",state:_objectSpread(_objectSpread({},c.state.params),{},{pagination:c.state.pagination,taskDefinitionKey:t.taskDefinitionKey,processDefinitionId:t.procDefId,processInstanceId:t.procInstId,taskId:t.taskId,pathName:"/processManager/busiTodotask/indexTask",tabName:"办理待办业务"})};(0,_tabRouter.goTo)(e,"办理待办业务")}}),_defineProperty(_assertThisInitialized(c),"toViewDiagram",function(e,a){return function(){var e=c.state.dataSource[a],t={pathname:_index.IS_OPEN_MULTI_TABNAV?"/processManager/mytodotask/diagram/"+e.taskId:"/processManager/mytodotask/diagram",state:_objectSpread(_objectSpread({},c.state.params),{},{pagination:c.state.pagination,processDefinitionId:e.procDefId,processInstanceId:e.procInstId,pathName:"/processManager/busiTodotask/indexTask",tabName:"待办业务信息"})};(0,_tabRouter.goTo)(t,"待办业务信息")}}),_defineProperty(_assertThisInitialized(c),"toTransfer",function(e,t,a){return function(){c.setState({visible:!0,selectRecord:e,operationType:a},function(){c.child.fetchData()})}}),_defineProperty(_assertThisInitialized(c),"handleSelectedApprover",function(e,t){c.setState({visible:e.visible,commentVisible:e.commentVisible}),t&&c.fetchTableData(c.state.params)}),_defineProperty(_assertThisInitialized(c),"onRef",function(e){c.child=e}),_defineProperty(_assertThisInitialized(c),"handleSearchTableData",function(e){c.fetchTableData(e)}),_defineProperty(_assertThisInitialized(c),"tablePaginationSearch",function(e){c.setState({pagination:e},function(){c.fetchTableData(c.state.params)})}),_defineProperty(_assertThisInitialized(c),"fetchTableData",function(e){(0,_fetchBusiData2.default)(e,c.state.pagination,c.state.fetchUrl).then(function(e){c.setState({busiLabel:e.busiLabel,latitude:"BUSI",isQueryCriteria:e.isQueryCriteria});var t=e.result.busiProcConfColumn,a=c.state.queryParams.busiLabel,r=(0,_defaultConfig.defaultConfig)(_assertThisInitialized(c))[a]?(0,_defaultConfig.defaultConfig)(_assertThisInitialized(c))[a].scrollXWidth:"",n=200;t.map(function(e){"1"==e.isDisplaytable&&(e.columnWidth?n+=parseInt(e.columnWidth):n+=100)});var o=r||n;t.push({columnAlias:"operation",columnDataType:"VARCHAR",columnDec:"操作",columnName:"操作",columnWidth:"",isDisplaytable:"1",isQueryCriteria:"0"});var i=e.result.page,s=c.state.pagination;s.total=i.total,s.current=i.pageNo,c.setState({pagination:s,params:e.params,columns:t,dataSource:e.result.busiRuTask,configKey:e.busiLabel,scroll:{x:o},rowKey:"taskId",parentThis:_assertThisInitialized(c)})})}),c.state={pagination:{pageSize:15,pageSizeChanger:!0,current:1},fetchUrl:"/workflow/queryBusiRuTask",queryParams:c.props.location.state},c}return _createClass(a,[{key:"componentDidMount",value:function(){var e={busiLabel:this.state.queryParams.busiLabel,procKey:this.state.queryParams.procKey,latitude:"BUSI"};this.fetchTableData(e)}},{key:"render",value:function(){return _react2.default.createElement("div",null,_react2.default.createElement("div",{className:"pandora-main-content"},_react2.default.createElement("div",{className:"portlet-tab"},_react2.default.createElement(_tabs2.default,{defaultActiveKey:"1",style:{marginBottom:7}},_react2.default.createElement(TabPane,{tab:"待办业务查询",key:"1"},_react2.default.createElement("div",{className:"portlet-body"},_react2.default.createElement("div",{className:"query-condition"},_react2.default.createElement(_queryComponent2.default,{formLayout:{formItemLayout:{labelCol:{span:6},wrapperCol:{span:18}},gridColLayout:{span:8,offset:1},gridButtonLayout:{span:8,offset:13}},busiLabel:this.state.busiLabel,procKey:this.state.procKey,latitude:this.state.latitude,isQueryCriteria:this.state.isQueryCriteria,getQueryData:this.handleSearchTableData})),_react2.default.createElement("div",{className:"role-table"},_react2.default.createElement("div",{className:"role-header"},_react2.default.createElement("div",{className:"role-list"},"待办业务列表"))),_react2.default.createElement(_tableComponent2.default,{scroll:this.state.scroll,rowKey:this.state.rowKey,parentThis:this.state.parentThis,columns:this.state.columns,dataSource:this.state.dataSource,configKey:this.state.configKey,pagination:this.state.pagination,defaultConfig:_defaultConfig.defaultConfig,handleTablePage:this.tablePaginationSearch,style:{paddingLeft:10,paddingRight:10}}),_react2.default.createElement(_selectNextApprover2.default,{visible:this.state.visible,operationType:this.state.operationType,selectRecord:this.state.selectRecord,handleSelectedApprover:this.handleSelectedApprover,onRef:this.onRef})))))))}}]),a}();exports.default=BusiTodotaskIndexTask,module.exports=exports.default;